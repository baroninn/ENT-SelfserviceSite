@model SystemHostingPortal.Models.Level30Model
@{
    ViewBag.Title = "Level30 > UpdateConf";
}
@section script {

    <script>
        $(document).ready(function () {
            
        $("select[name=organization]").change(function () {
            $("#currentConf").html("Loading, this could take some time...");
            $("#Domain").html("Loading, this could take some time...");
            GetCurrentConf();
            GetDomain();
        });

        $("#currentConf").html("Loading, this could take some time...");
        $("#Domain").html("Loading, this could take some time...");
        GetCurrentConf();
        GetDomain();
    });

    </script>
}

<h1 class="title">@ViewBag.Title</h1>
<p>Use this form to update the Conf file for a given customer.</p>
<br />

@using (Html.BeginForm("UpdateConf", "Level30"))
{
    <fieldset>
        <legend>Update Configuration</legend>
        <table>
            <tr>
                <td colspan="2">
                    <div id="messageDiv">
                        @if (Model.Message != null)
                        {
                            <div class="message">@Model.Message <p><small><a href="javascript:ClearErrors()">Clear errors</a></small></p></div>
                        }
                    </div>
                    <div id="okMessageDiv">
                        @if (Model.OKMessage.Count > 0)
                        {
                            <div class="okmessage">
                                @foreach (string msg in Model.OKMessage)
                                {
                                    <p>@msg</p>
                                }
                                <p><small><a href="javascript:ClearMessages()">Clear messages</a></small></p>
                            </div>
                        }
                    </div>
                </td>
            </tr>

            <tr>
                <td class="lefttd"><span>Organization</span></td>
                <td class="middletd">
                    <select name="organization">
                        @foreach (string organization in Model.Organizations)
                        {
                            <option @if (Model.ActionFailed) { if (organization == Model.UpdateConf.Organization) { @: selected="selected"
                                                                                                                                            } }>
                                @organization
                            </option>
                        }
                    </select>
                    <span class="mandatory">*</span>
                </td>
            </tr>
            <tr>
                <td class="lefttd tooltip"><span>Exchange Server (FQDN)<i class="material-icons infoicon">info</i></span></td>
                <td class="middletd">
                    <input name="exchangeserver"  placeholder="XXX-exch-01.XXX.XXX.dk" @if (Model.ActionFailed) {  @: value="@Model.UpdateConf.ExchangeServer"
                                                                                                                                                              } />

                    <div class="description">
                        <p class="descriptiontext">
                            If this is set, the conf will not look at Office365. Make sure you set this to "null" if the customer has Office365. You actually have to write null, if the customer previously has had their own exchange server..
                        </p>
                    </div>
                </td>
            </tr>
            <tr>
                <td class="lefttd tooltip"><span>Domain FQDN<i class="material-icons infoicon">info</i></span></td>
                <td class="middletd">
                    <input name="domainfqdn" placeholder="XXX.XXX.dk" @if (Model.ActionFailed) {  @: value="@Model.UpdateConf.DomainFQDN"
                                                                                                                                                      } />
                    <div class="description">
                        <p class="descriptiontext">
                            This is mandatory..
                        </p>
                    </div>
                </td>
            </tr>
            <tr>
                <td class="lefttd tooltip"><span>Domain NETBIOS<i class="material-icons infoicon">info</i></span></td>
                <td class="middletd">
                    <input name="netbios" placeholder="CORP" @if (Model.ActionFailed) {  @: value="@Model.UpdateConf.NETBIOS"
                                                                                                                                                                                 } />
                    <div class="description">
                        <p class="descriptiontext">
                            This is mandatory..
                        </p>
                    </div>
                </td>
            </tr>

            <tr>
                <td class="lefttd tooltip"><span>Customer OU DN<i class="material-icons infoicon">info</i></span></td>
                <td class="middletd">
                    <input name="customeroudn" placeholder="OU=CUSTOMER,DC=XXX,DC=XXX,DC=dk" @if (Model.ActionFailed) {  @: value="@Model.UpdateConf.CustomerOUDN"
                                                                                                                                                                             } />
                    <div class="description">
                        <p class="descriptiontext">
                            The Distinguishedname
                        </p>
                    </div>
                </td>
            </tr>

            <tr>
                <td class="lefttd tooltip"><span>Domains<i class="material-icons infoicon">info</i></span></td>
                <td class="middletd">
                    @if (Model.ActionFailed)
                {
                    <textarea name="domains" rows="5" placeholder="Write one domain per line">@string.Join("\r\n", Model.UpdateConf.Domains)</textarea>
                }
                else
                {
                    <textarea name="domains" rows="5" placeholder="Write one domain per line"></textarea>
                }

                    <div class="description">
                        <p class="descriptiontext">
                            This is the FULL list of domains available for the customer. Therefore, always fill out this field will all domains, not just the domain you wish to add to conf.
                        </p>
                    </div>
            </td>
        </tr>
            <tr>
                <td class="lefttd tooltip"><span>365 TenantID<i class="material-icons infoicon">info</i></span></td>
                <td class="middletd">
                    <input name="tenantid365" placeholder="43eea929-d726-4742-83a9-603c12a0d195" @if (Model.ActionFailed) {  @: value="@Model.UpdateConf.TenantID365"
                                                                          } />
                    <div class="description">
                        <p class="descriptiontext">
                            TenantID from CSP partner portal..
                        </p>
                    </div>
                </td>
            </tr>
            <tr>
                <td class="lefttd">365 Admin User</td>
                <td class="middletd">
                    <input name="adminuser365" placeholder="admin@XXX.dk" @if (Model.ActionFailed) {  @: value="@Model.UpdateConf.AdminUser365"
                                                                             } />
                </td>
            </tr>
            <tr>
                <td class="lefttd">365 Admin Pass</td>
                <td class="middletd">
                    <input name="adminpass365" placeholder="XXXXXXXX" @if (Model.ActionFailed) {  @: value="@Model.UpdateConf.AdminPass365"
                                                                             } />
                </td>
            </tr>
            <tr>
                <td class="lefttd">AADSynced</td>
                <td class="middletd">
                    <input name="aadsynced" placeholder="True" @if (Model.ActionFailed) {  @: value="@Model.UpdateConf.AADsynced"
                                                                                } />
                </td>
            </tr>
            <tr>
                <td class="lefttd">ADConnect Server</td>
                <td class="middletd">
                    <input name="adconnectserver" placeholder="xxx-xx-xx.corp.xxxxxxx.dk" @if (Model.ActionFailed) {  @: value="@Model.UpdateConf.ADConnectServer"
                                                                                      } />
                </td>
            </tr>
            <tr>
                <td class="lefttd">AD Server</td>
                <td class="middletd">
                    <input name="domaindc" placeholder="xxx-xx-xx.corp.xxxxxxx.dk" @if (Model.ActionFailed) {  @: value="@Model.UpdateConf.DomainDC"
                                                                                      } />
                </td>
            </tr>

        </table>
        <br />
        <input type="submit" class="button" class:hover="button:hover" id="buttonSubmit" value="Update Configuration" onclick="buttonSubmit.disabled = true; ClearMessages(); ClearErrors(); StartSubmitButtonMessage(); this.form.submit()" />
    </fieldset>

    <fieldset>
        <legend>Current configuration</legend>
        <table>
            <tr>
                <td class="middletd">
                    <div id="currentConf"></div>
                </td>
            </tr>
        </table>
        <fieldset>
            <legend>Domains</legend>
            <table>
                <tr>
                    <td>
                        <div style="text-align:left; align-items:center" id="Domain"></div>
                    </td>
                </tr>
            </table>
        </fieldset>

   </fieldset>
}