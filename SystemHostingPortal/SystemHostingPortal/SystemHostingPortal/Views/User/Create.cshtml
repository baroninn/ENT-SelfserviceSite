@model SystemHostingPortal.Models.UserModel
@{
    ViewBag.Title = "User > Create";
}
@section script {
<script>
        $(document).ready(function () {
            if (navigator.userAgent.match(/msie/gi)) { alert('This page is not supported in MSIE'); }

            GetAcceptedDomain2();
            GetADUsersList();

            $("select[name=organization]").change(function () {
                $("select[name=domainname]").html('<option>loading...</option>');
                $("select[name=distinguishedname]").html('<option>loading...</option>');

                GetAcceptedDomain2();
                GetADUsersList();

            });
        });
</script>
}

<h1 class="title">@ViewBag.Title</h1>
<p>Use this form to create a new user account.</p>

@using(Html.BeginForm("Create", "User")) {
<fieldset>
    <legend>Create user</legend>
    <table>
        <tr>
            <td colspan="2">@if(Model.Message != null) { <div class="message">@Model.Message</div> }</td>
        </tr>
        <tr>
            <td class="lefttd">Organization</td>
            <td><select name="organization">
                    @foreach(string organization in Model.Organizations) 
                    {
                            <option @if(Model.ActionFailed)
                                    {
                                        if(organization == Model.UserList[0].Organization) {
                                            @:selected="selected"
                                        }
                                    }>@organization</option>
                    }
                </select></td>
        </tr>
        <tr>
            <td class="lefttd"><span>Copy settings from<i class="material-icons infoicon"></i></span></td>
            <td class="righttd">
                <select name="distinguishedname"><option>loading...</option></select>
            </td>
        </tr>
        <tr>
            <td class="lefttd">First name</td>
            <td>
                <input name="firstname" placeholder="John" @if (Model.ActionFailed) {  @: value="@Model.UserList[0].FirstName"
                                                                                     } />
            </td>
        </tr>
        <tr>
            <td class="lefttd">Last name</td>
            <td>
                <input name="lastname" placeholder="Doe" @if (Model.ActionFailed) {  @: value="@Model.UserList[0].LastName"
                                                                                     } />
            </td>
        </tr>

    </table>
    <table>
        <tr>
            <td class="lefttd">Primary email</td>
            <td class="lefttd"><input name="userprincipalname" placeholder="john.doe" @if (Model.ActionFailed)
                                                                                   { 
                                                                  @:value="@Model.UserList[0].UserPrincipalName" 
                                                                                    }/>
            </td>
            <td><p>@@</p></td>
            <td class="lefttdaccepteddomain">
                <select name="domainname"><option>loading...</option></select>
            </td>

        </tr>
    </table>
    <table>
        
        <tr>
            <td class="lefttd">Password</td>
            <td><input name="password" placeholder="Something insane like Qwerty..." @if (Model.ActionFailed)
                                                              { 
                                                                  @:value="@Model.UserList[0].Password" 
                                                              }/></td>
        </tr>
        <tr>
            <td class="lefttd tooltip"><span>Password Never Expires<i class="material-icons infoicon">info</i></span></td>
            <td>
                <input name="passwordneverexpires" type="checkbox" @if (Model.ActionFailed)
                                                                   {
                                                                       if (Model.UserList[0].PasswordNeverExpires)
                                                                       {
                                                                           @:checked="checked"
                                                                       }
                                                                   } />
                <div class="description">
                    <p class="descriptiontext">
                        Passwords will never expire if this is checked. This must be confirmed by the organization first.
                    </p>
                </div>
            </td>
        </tr>
        <tr>
            <td class="lefttd tooltip"><span>Test user<i class="material-icons infoicon">info</i></span></td>
            <td><input name="testuser" type="checkbox" @if (Model.ActionFailed)
                                                           { 
                                                                if(Model.UserList[0].TestUser) { 
                                                                    @:checked="checked"
                                                                }
                                                            }/>
                <div class="description">
                    <p class="descriptiontext">
                        Users marked as Test User are for testing purposes, and must not be used for real users. These users does not count towards mailbox quota or SPLA's. But data left in these accounts will take up space on their file server.
                    </p>
                </div>
            </td>
        </tr>
    </table>
    <br />
    <input type="submit" class="button" class:hover="button:hover" id="buttonSubmit" value="Create" onclick="buttonSubmit.disabled = true; ClearMessages(); ClearErrors(); StartSubmitButtonMessage(); this.form.submit()" />
</fieldset>
    
}