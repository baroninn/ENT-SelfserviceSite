function GetDomain(){var n=$("select[name=organization]").val();$("#Domain").html("loading, this could take some time...");$.get("/Mail/GetDomain?organization="+n,function(n){$("#Domain").html(n)})}function GetTenantID(){var n=$("select[name=organization]").val();$("#TenantID").html("loading, this could take some time...");$.get("/Office365/GetTenantID?organization="+n,function(n){$("#TenantID").html(n)})}function GetCurrentConf(){var n=$("select[name=organization]").val();$("#currentConf").html("loading, this could take some time...");$.get("/Level30/getCurrentConf?organization="+n,function(n){$("#currentConf").html(n)})}function GetCurrentConfLIST(){var n=$("select[name=organization]").val();$.get("/Level30/GetCurrentConfLIST",{organization:n},function(n){var t=JSON.parse(n);for(i=0;i<t.length;i++)document.getElementById("Name").value=t[i].Name,document.getElementById("DomainFQDN").value=t[i].DomainFQDN,document.getElementById("UserContainer").value=t[i].UserContainer,document.getElementById("ExchangeServer").value=t[i].ExchangeServer,document.getElementById("NETBIOS").value=t[i].NETBIOS,document.getElementById("CustomerOUDN").value=t[i].CustomerOUDN,document.getElementById("AdminUserOUDN").value=t[i].AdminUserOUDN,document.getElementById("ExternalUserOUDN").value=t[i].ExternalUserOUDN,document.getElementById("TenantID").value=t[i].TenantID,document.getElementById("AdminUser").value=t[i].AdminUser,document.getElementById("AdminPass").value=t[i].AdminPass,document.getElementById("AADsynced").value=t[i].AADsynced,document.getElementById("ADConnectServer").value=t[i].ADConnectServer,document.getElementById("DomainDC").value=t[i].DomainDC,document.getElementById("NavMiddleTier").value=t[i].NavMiddleTier,document.getElementById("SQLServer").value=t[i].SQLServer,document.getElementById("AdminRDS").value=t[i].AdminRDS,document.getElementById("AdminRDSPort").value=t[i].AdminRDSPort,document.getElementById("EmailDomains").value=t[i].EmailDomains.split(",").join("\n")})}function GetAliases(){var t=$("select[name=organization]").val(),i=$("select[name=userprincipalname]").val(),n=$("#existingAliases");n.html("loading...");$.getJSON("/Ajax/GetADUsersProxy",{organization:t,userprincipalname:i},function(t){n.html("");$.each(t[0].proxyAddresses,function(t,i){var u=i.substring(0,4),r=i.substring(5);u=="SMTP"&&(r=r+" (<b>Primary<\/b>)");n.append("<li>"+r+"<\/li>")})})}function AddMailboxToList(n,t,i){if(!t||n.RecipientTypeDetails==t||t.toUpperCase()=="ALL")i.append('<option value="'+n.UserPrincipalName+'">'+n.Name+" ["+n.RecipientTypeDetails+"] - "+n.UserPrincipalName+"<\/option>")}function GetMailbox(n,t){t||(t=$("select[name=userprincipalname]"));var r=$("select[name=organization]").val();t.html("<option>Contacting Exchange server / Office365...<\/option>");$.get("/Ajax/GetMailbox",{organization:r},function(r){t.html("");var u=JSON.parse(r);if(u.Failure)AddError(u);else if(t.html(""),u.length==null)AddMailboxToList(u,n,t);else for(i=0;i<u.length;i++)AddMailboxToList(u[i],n,t);t.change()})}function GetMailforward(){$("#existingforwards").html("... loading");var n=$("select[name=organization]").val(),t=$("select[name=userprincipalname]").val();$.getJSON("/Ajax/GetMailforward",{organization:n,userprincipalname:t},function(n){if(n.Name!="empty"&&n.ForwardingAddress!="empty"){var t="ForwardOnly";n.DeliverToMailboxAndForward&&(t="DeliverToMailboxAndForward");$("#existingforwards").html(n.ForwardingAddress+" ("+n.Name+", "+t+")")}else $("#existingforwards").html("None")})}function GetRandomInt(n,t){return Math.floor(Math.random()*(t-n+1))+n}function GetWorkingMessage(){var n=["Making a Ninja!!","Just thinking...","Partitioning Social Network","Blurring Reality Lines","Reticulating 3-Dimensional Splines","Preparing Captive Simulators","Capacitating Genetic Modifiers","Destabilizing Orbital Payloads","Manipulating Modal Memory","Testing Underworld Telecommunications","Caffeinating Programmer Body","Initializing Secret Societies","Reticulating Graduated Splines","Loading Lightsaber Sounds","Turning On Turn-Ons","Disgruntling Employees","Managing Managers Managers","Preparing Bacon for Homeward Transportation","Mitigating Time-Stream Discontinuities",'Loading "First Batch" Metrics',"Neutralizing Shuriken Oxidization","Roof = Roof(1/3*pi*r^2*h)","Atomizing Atomic Particles","Readying Relaxation Receptors","Training File Server Behavior","Calculating Lifetime Aspirations","Predicating Predestined Paths","Writing Scrolling Startup String Text","Making a Little Bit of Magic","Rasterizing Reputation Algorithms","Simulating Sparkling Surfaces","Reverse-Engineering Coffee","Cooling Down Refrigerators","Storing Solar Energy","Ceiling Fan Rotation = dL/dT","Filling in the Blanks","Generating Intrigue","Inserting Chaos Generator","Concatenating Vertex Nodes","Extruding Mesh Terrain","Simulating Program Execution","Locating Misplaced Calculations","Recycling Hex Decimals","Ensuring Transplanar Synergy","Abstracting Loading Procedures","Polarizing Image Conduits"];return n[GetRandomInt(0,n.length-1)]}function StartSubmitButtonMessage(){$("input[type=submit]").val("Working...");setTimeout(UpdateSubmitButtonMessage,5e3)}function UpdateSubmitButtonMessage(){$("input[type=submit]").val(GetWorkingMessage()+"...");setTimeout(UpdateSubmitButtonMessage,3e4)}function AddDomainToList(n,t){t.append('<option value="'+n.DomainName+'">'+n.DomainName+"<\/option>")}function GetDomainSelect(n){n||(n=$("select[name=domainname]"));var t=$("select[name=organization]").val();n.html("<option>loading...<\/option>");$.get("/Ajax/GetDomain",{organization:t},function(t){n.html("");var r=JSON.parse(t);if(r.Failure)AddError(r);else if(n.html(""),r.length==null)AddDomainToList(r,n);else for(i=0;i<r.length;i++)AddDomainToList(r[i],n);n.change()})}function AddSendAsGroupToList(n,t){t.append('<option value="'+n.DistinguishedName+'">'+n.Description+" - "+n.Name+"<\/option>")}function GetSendAsGroups(n){n||(n=$("select[name=distinguishedname]"));var t=$("select[name=organization]").val();n.html("<option>loading...<\/option>");$.get("/Ajax/GetSendAsGroups",{organization:t},function(t){n.html("");var r=JSON.parse(t);if(r.Failure)AddError(r);else if(n.html(""),r.length==null)AddSendAsGroupToList(r,n);else for(i=0;i<r.length;i++)AddSendAsGroupToList(r[i],n);n.change()})}function AddUserToList(n,t){t.append('<option value="'+n.UserPrincipalName+'">'+n.Name+" - "+n.UserPrincipalName+" - ["+n.Enabled+"]<\/option>")}function GetADUsersList(n){n||(n=$("select[name=userprincipalname]"));var t=$("select[name=organization]").val();n.html("<option>Contacting Domain Controller...<\/option>");$.get("/Ajax/GetADUsersList",{organization:t},function(t){n.html("");var r=JSON.parse(t);if(r.Failure)AddError(r);else if(n.html(""),r.length==null)AddUserToList(r,n);else for(i=0;i<r.length;i++)AddUserToList(r[i],n);n.change()})}function AddVMToList(n,t){t.append('<option value="'+n.VMID+'">'+n.Name+"<\/option>")}function GetVMServers(n){n||(n=$("select[name=vmid]"));n.html("<option>loading, this could take some time (VMM is a little slow)...<\/option>");$.get("/Ajax/GetVMServers",function(t){n.html("");var r=JSON.parse(t);if(r.Failure)AddError(r);else if(n.html(""),r.length==null)AddVMToList(r,n);else for(i=0;i<r.length;i++)AddVMToList(r[i],n);n.change()})}function GetVMServerslvl25(n){n||(n=$("select[name=vmid]"));n.html("<option>loading, this could take some time (VMM is a little slow)...<\/option>");$.get("/Ajax/GetVMServerslvl25",function(t){n.html("");var r=JSON.parse(t);if(r.Failure)AddError(r);else if(n.html(""),r.length==null)AddVMToList(r,n);else for(i=0;i<r.length;i++)AddVMToList(r[i],n);n.change()})}function AddVHDToList(n,t){t.append('<option value="'+n.VHDID+'">'+n.Name+" - ["+n.Size+" GB]<\/option>")}function GetVMVHDs(n){n||(n=$("select[name=vhdid]"));var t=$("select[name=vmid]").val();n.html("<option>loading, this could take some time (VMM is a little slow)...<\/option>");$.get("/Ajax/GetVMVHDs",{vmid:t},function(t){n.html("");var r=JSON.parse(t);if(r.Failure)AddError(r);else if(n.html(""),r.length==null)AddVHDToList(r,n);else for(i=0;i<r.length;i++)AddVHDToList(r[i],n);n.change()})}function GetVMInfo(){var n=$("select[name=vmid]").val();$("#vminfo").html("Loading...");$.get("/Level30/GetVMInfo?vmid="+n,function(n){$("#vminfo").html(n)})}function GetAdminUsers(){$("#adminusers").html("Loading...");$.get("/Level30/GetAdminUsers?",function(n){$("#adminusers").html(n)})}function GetVMInfo2(){var n=$("select[name=vmid]").val();$("#vminfo2").html("Loading...");$.get("/Level30/GetVMInfo3?vmid="+n,function(n){$("#vminfo2").html(n)})}function AddO365DomainToList(n,t,i){if(n.Status==t)i.append('<option value="'+n.DomainName+'">'+n.DomainName+"<\/option>")}function GetO365DomainSelect(n,t){t||(t=$("select[name=domainname]"));var r=$("select[name=organization]").val();t.html("<option>loading...<\/option>");$.get("/Ajax/GetO365Domain",{organization:r},function(r){t.html("");var u=JSON.parse(r);if(u.Failure)AddError(u);else if(t.html(""),u.length==null)AddO365DomainToList(u,n,t);else for(i=0;i<u.length;i++)AddO365DomainToList(u[i],n,t);t.change()})}function AddAdminToList(n,t){t.append('<option value="'+n.SamAccountName+'">'+n.DisplayName+"  -  ["+n.SamAccountName+"]<\/option>")}function GetAdminUsersLIST(n){n||(n=$("select[name=samaccountname]"));n.html("<option>loading...<\/option>");$.get("/Level30/GetAdminUsersLIST?",function(t){n.html("");var r=JSON.parse(t);if(r.Failure)AddError(r);else if(n.html(""),r.length==null)AddAdminToList(r,n);else for(i=0;i<r.length;i++)AddAdminToList(r[i],n);n.change()})}function GetPendingReboot(){$("#pendingreboot").html("loading, this could take some time...");$.get("/Service/GetPendingReboot?",function(n){$("#pendingreboot").html(n)})}function GetLatestAlerts(n){$("#latestalerts").html("Contacting DB... please be patient..");$.get("/Service/GetLatestAlerts?alert="+n,function(n){$("#latestalerts").html(n)})}function GetAlertFreeSpace(){$("#alertfree").html("Contacting DB... please be patient..");$.get("/Service/GetAlertFreeSpace?",function(n){$("#alertfree").html(n)})}function GetScheduledJobs(n){$("#scheduledjobs").html("Contacting DB... please be patient..");$.get("/Service/GetScheduledJobs?job="+n,function(n){$("#scheduledjobs").html(n)})}function GetCompletedEXTAdminUsers(){var n=$("select[name=organization]").val();$("#completedAdmins").html("Contacting DB... please be patient..");$.get("/Level30/GetEXTAdminUsers",{status:"Done",organization:n},function(n){$("#completedAdmins").html(n)})}function GetscheduledEXTAdminUsers(){var n=$("select[name=organization]").val();$("#scheduledAdmins").html("Contacting DB... please be patient..");$.get("/Level30/GetEXTAdminUsers",{status:"Scheduled",organization:n},function(n){$("#scheduledAdmins").html(n)})}function GeneratePassword(){for(var n,i="ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",t="",r=0,u=0,f=0;f<10;f++)Math.floor(Math.random()*2)==0&&u<3||r>=5?(n=Math.floor(Math.random()*10),t+=n,u+=1):(n=Math.floor(Math.random()*i.length),t+=i.substring(n,n+1),r+=1);return t}function AddEXTAdminToList(n,t){t.append('<option value="'+n.ID+'">'+n.ID+" "+n.FirstName+" "+n.LastName+"  -  ["+n.Company+"] - ["+n.Organization+"]<\/option>")}function GetEXTAdminUsersLIST(n,t){t||(t=$("select[name=id]"));var r=$("select[name=organization]").val();t.html("<option>loading...<\/option>");$.get("/Level30/GetEXTAdminUsersSELECT",{id:"",status:n,organization:r},function(n){t.html("");var r=JSON.parse(n);if(r.Failure)AddError(r);else if(t.html(""),r.length==null)AddEXTAdminToList(r,t);else for(i=0;i<r.length;i++)AddEXTAdminToList(r[i],t);t.change()})}function GetEXTAdminUser(n){var n=$("select[name=id]").val(),t=$("select[name=organization]").val();$.get("/Level30/GetEXTAdminUsersSELECT",{id:n,organization:t},function(n){var t=JSON.parse(n);for(i=0;i<t.length;i++)document.getElementById("description").value=t[i].Description,document.getElementById("email").value=t[i].Email,document.getElementById("firstname").value=t[i].FirstName,document.getElementById("lastname").value=t[i].LastName,document.getElementById("company").value=t[i].Company,document.getElementById("customer").value=t[i].Customer,document.getElementById("expiredate").value=t[i].ExpireDate})}function AddCASAdminToList(n,t){t.append('<option value="'+n.ID+'">'+n.ID+" "+n.FirstName+" "+n.LastName+"  -  ["+n.UserName+"] - ["+n.Organization+"]<\/option>")}function GetCASAdminUsersLIST(n,t){t||(t=$("select[name=id]"));var r=$("select[name=organization]").val();t.html("<option>loading...<\/option>");$.get("/Level30/GetCASAdminUsersSELECT",{id:"",status:n,organization:r},function(n){t.html("");var r=JSON.parse(n);if(r.Failure)AddError(r);else if(t.html(""),r.length==null)AddCASAdminToList(r,t);else for(i=0;i<r.length;i++)AddCASAdminToList(r[i],t);t.change()})}function GetCASAdminUser(n){var n=$("select[name=id]").val(),t=$("select[name=organization]").val();$.get("/Level30/GetCASAdminUsersSELECT",{id:n,organization:t},function(n){var t=JSON.parse(n);for(i=0;i<t.length;i++)document.getElementById("description").value=t[i].Description,document.getElementById("email").value=t[i].Email,document.getElementById("firstname").value=t[i].FirstName,document.getElementById("lastname").value=t[i].LastName,document.getElementById("company").value=t[i].Company,document.getElementById("customer").value=t[i].Customer,document.getElementById("expiredate").value=t[i].ExpireDate})}function GetCompletedCASAdminUsers(){var n=$("select[name=organization]").val();$("#completedCASAdmins").html("Contacting DB... please be patient..");$.get("/Level30/GetCASAdminUsers",{status:"ALL",organization:n},function(n){$("#completedCASAdmins").html(n)})}function GetCurrentSharedCustomerConfLIST(){var n=$("select[name=organization]").val();$.get("/Level30/GetCurrentSharedCustomerConfLIST",{organization:n},function(n){var t=JSON.parse(n);for(i=0;i<t.length;i++)document.getElementById("Name").value=t[i].Name,document.getElementById("NavMiddleTier").value=t[i].NavMiddleTier,document.getElementById("SQLServer").value=t[i].SQLServer})}function GetCASOrganizations(){$("#CasOrganizations").html("Contacting DB... please be patient..");$.get("/Level30/GetCASOrganizations?",function(n){$("#CasOrganizations").html(n)})}if($("#back-to-top").length){var scrollTrigger=100,backToTop=function(){var n=$(window).scrollTop();n>scrollTrigger?$("#back-to-top").addClass("show"):$("#back-to-top").removeClass("show")};backToTop();$(window).on("scroll",function(){backToTop()});$("#back-to-top").on("click",function(n){n.preventDefault();$("html,body").animate({scrollTop:0},700)})}